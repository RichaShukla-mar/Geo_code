select E.GDA_DFND_AREA_PRNT_ROWID as bdaRowID,
       F.NAME                     as name,
       G.NAME                     as type,
       H.BDA_TYPE_CD              as bdatype
from C_FCT_ALT_CODES A
         INNER JOIN C_TYP_TYPE B
                    ON B.ROWID_OBJECT = A.TYP_TYPE_ROWID AND B.HUB_STATE_IND = 1 and B.CODE = 'ALT_CODE.GEOID'
         INNER JOIN C_ALT_CODE C ON C.CODE = A.CODE AND C.HUB_STATE_IND = 1
         INNER JOIN C_GDA_DFND_AREA D
                    ON D.ROWID_OBJECT = C.GDA_DFND_AREA_ROWID AND D.HUB_STATE_IND = 1 and TYP_TYPE_CD = 'GDA.SITE'
         INNER JOIN C_GDA_DFND_AREA_REL E ON E.GDA_DFND_AREA_CHLD_ROWID = D.ROWID_OBJECT AND E.HUB_STATE_IND = 1 and
                                             E.TYP_TYPE_CD in ('GDA_REL.GDA_IN_BDA')
         INNER JOIN C_GDA_DFND_AREA F ON F.ROWID_OBJECT = E.GDA_DFND_AREA_PRNT_ROWID AND F.HUB_STATE_IND = 1
         INNER JOIN C_TYP_TYPE G ON G.CODE = F.TYP_TYPE_CD AND G.HUB_STATE_IND = 1
         INNER JOIN C_GDA_BDA H ON H.GDA_DFND_AREA_ROWID = E.GDA_DFND_AREA_PRNT_ROWID AND G.HUB_STATE_IND = 1
where A.HUB_STATE_IND = 1 AND A.FCT_ROWID=?
